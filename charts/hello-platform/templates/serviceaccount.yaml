{{/* Only render this template if serviceAccount.create is true in values.yaml */}}
{{- if .Values.serviceAccount.create -}}
# Kubernetes API version for ServiceAccount resources
apiVersion: v1
# Resource type: provides an identity for processes running inside Pods
kind: ServiceAccount
metadata:
  # ServiceAccount name from the helper template
  name: {{ include "hello-platform.serviceAccountName" . }}
  # Standard Helm labels
  labels:
    {{- include "hello-platform.labels" . | nindent 4 }}
  {{/* Conditionally add user-defined annotations (e.g., for IAM role binding) */}}
  {{- with .Values.serviceAccount.annotations }}
  annotations:
    {{- toYaml . | nindent 4 }}
  {{- end }}
# Controls whether the ServiceAccount's token is automatically mounted into Pods
automountServiceAccountToken: {{ .Values.serviceAccount.automount }}
{{/* End the conditional block â€” no ServiceAccount is created if disabled */}}
{{- end }}
